{"version":3,"sources":["../src/skill.js"],"names":["Flow","Node","renderElement","runAction","genId","Math","random","toString","substr","_renderElement","type","args","isString","JSON","stringify","config","obj","version","name","location","startNode","nodes","length","Error","filter","n","id","onEnter","onReceive","next"],"mappings":";;;;;;;;QAegBA,I,GAAAA,I;QA0BAC,I,GAAAA,I;QAsBAC,a,GAAAA,a;QAUAC,S,GAAAA,S;;AAzEhB;;;;;;AAEA,MAAMC,QAAQ,MACZC,KAAKC,MAAL,GACGC,QADH,GAEGC,MAFH,CAEU,CAFV,EAEa,CAFb,CADF;;AAKA,MAAMC,iBAAiB,CAACC,IAAD,EAAOC,IAAP,KAAgB;AACrC,MAAI,iBAAEC,QAAF,CAAWD,IAAX,CAAJ,EAAsB;AACpB,WAAQ,OAAMD,IAAK,IAAGC,IAAK,EAA3B;AACD,GAFD,MAEO;AACL,WAAQ,OAAMD,IAAK,IAAGG,KAAKC,SAAL,CAAeH,IAAf,CAAqB,EAA3C;AACD;AACF,CAND;;AAQO,SAASX,IAAT,CAAce,MAAd,EAAsB;AAC3B,QAAMC,mBAAWD,MAAX,CAAN;;AAEA,MAAI,CAACC,IAAIC,OAAT,EAAkB;AAChBD,QAAIC,OAAJ,GAAc,KAAd;AACD;;AAED,MAAI,CAACD,IAAIE,IAAL,IAAa,CAACF,IAAIG,QAAtB,EAAgC;AAC9BH,QAAIE,IAAJ,GAAWF,IAAIG,QAAJ,GAAef,OAA1B;AACD;;AAED,MAAI,CAACY,IAAII,SAAT,EAAoB;AAClB,QAAI,CAACJ,IAAIK,KAAL,IAAcL,IAAIK,KAAJ,CAAUC,MAAV,IAAoB,CAAtC,EAAyC;AACvC,YAAM,IAAIC,KAAJ,CAAU,uCAAV,CAAN;AACD;;AAED,QAAI,CAACP,IAAIK,KAAJ,CAAUG,MAAV,CAAiBC,KAAKA,EAAEP,IAAF,KAAW,OAAjC,EAA0CI,MAA/C,EAAuD;AACrDN,UAAII,SAAJ,GAAgBJ,IAAIK,KAAJ,CAAU,CAAV,EAAaH,IAA7B;AACD;;AAEDF,QAAII,SAAJ,GAAgB,OAAhB;AACD;;AAED,SAAOJ,GAAP;AACD;;AAEM,SAASf,IAAT,CAAcc,MAAd,EAAsB;AAC3B,QAAMC,mBAAWD,MAAX,CAAN;;AAEA,MAAI,CAACC,IAAIU,EAAT,EAAa;AACXV,QAAIU,EAAJ,GAAStB,OAAT;AACD;;AAED,MAAI,CAACY,IAAIW,OAAT,EAAkB;AAChBX,QAAIW,OAAJ,GAAc,EAAd;AACD;;AAED,MAAI,CAACX,IAAIY,SAAT,EAAoB;AAClBZ,QAAIY,SAAJ,GAAgB,IAAhB;AACD;;AAED,MAAI,CAACZ,IAAIa,IAAT,EAAe;AACbb,QAAIa,IAAJ,GAAW,EAAX;AACD;;AAED,SAAOb,GAAP;AACD;;AAEM,SAASd,aAAT,CAAuB,GAAGS,IAA1B,EAAgC;AACrC,MAAIA,KAAKW,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAOb,eAAe,eAAf,EAAgCE,KAAK,CAAL,CAAhC,CAAP;AACD,GAFD,MAEO,IAAIA,KAAKW,MAAL,KAAgB,CAApB,EAAuB;AAC5B,WAAOb,eAAeE,KAAK,CAAL,CAAf,EAAwBA,KAAK,CAAL,CAAxB,CAAP;AACD,GAFM,MAEA;AACL,UAAM,IAAIY,KAAJ,CAAU,wCAAV,CAAN;AACD;AACF;;AAEM,SAASpB,SAAT,CAAmBe,IAAnB,EAAyBP,IAAzB,EAA+B;AACpC,SAAOA,OAAQ,GAAEO,IAAK,IAAGL,KAAKC,SAAL,CAAeH,IAAf,CAAqB,EAAvC,GAA2CO,IAAlD;AACD","file":"skill.js","sourcesContent":["import _ from 'lodash'\n\nconst genId = () =>\n  Math.random()\n    .toString()\n    .substr(2, 6)\n\nconst _renderElement = (type, args) => {\n  if (_.isString(args)) {\n    return `say ${type} ${args}`\n  } else {\n    return `say ${type} ${JSON.stringify(args)}`\n  }\n}\n\nexport function Flow(config) {\n  const obj = { ...config }\n\n  if (!obj.version) {\n    obj.version = '0.0'\n  }\n\n  if (!obj.name || !obj.location) {\n    obj.name = obj.location = genId()\n  }\n\n  if (!obj.startNode) {\n    if (!obj.nodes || obj.nodes.length <= 0) {\n      throw new Error('Expected at least one node in `nodes`')\n    }\n\n    if (!obj.nodes.filter(n => n.name === 'entry').length) {\n      obj.startNode = obj.nodes[0].name\n    }\n\n    obj.startNode = 'entry'\n  }\n\n  return obj\n}\n\nexport function Node(config) {\n  const obj = { ...config }\n\n  if (!obj.id) {\n    obj.id = genId()\n  }\n\n  if (!obj.onEnter) {\n    obj.onEnter = []\n  }\n\n  if (!obj.onReceive) {\n    obj.onReceive = null\n  }\n\n  if (!obj.next) {\n    obj.next = []\n  }\n\n  return obj\n}\n\nexport function renderElement(...args) {\n  if (args.length === 1) {\n    return _renderElement('#builtin_text', args[0])\n  } else if (args.length === 2) {\n    return _renderElement(args[0], args[1])\n  } else {\n    throw new Error('Can only call say with one or two args')\n  }\n}\n\nexport function runAction(name, args) {\n  return args ? `${name} ${JSON.stringify(args)}` : name\n}\n"]}